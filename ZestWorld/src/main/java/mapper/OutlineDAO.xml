<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zestworld.OutlineDAO.IOutlineDAO">
	<select id="tasklist" resultType="com.zestworld.Table_DTO.Task_DTO">
		select * from task where success_f='0' order by enrolldate desc
	</select>
	
 
	<select id="taskTest" resultType="com.zestworld.Table_DTO.Task_DTO" parameterType="com.zestworld.Table_DTO.Task_DTO">
		
		select * from task where enrolldate between #{filterDay} and sysdate  and  success_f=#{success_f}<!-- default= 작성자가 나인것  -->
		
		<if test="userid!=null and userid !=''">
			and user_id=#{user_id}
		</if>
		
		<if test="member!=null and member != ''">  <!-- 배정된 멤버  -->
			and member=#{member}
		</if>
		
		<if test="follower!=null and follower != ''">  <!-- 팔로워  -->
			and follower=#{follower}
		</if>
		
		<!-- <if test="success_f!=null and success_f != ''">  성공여부 
			and success_f=#{success_f}
		</if> -->
		<if test="order.equals('desc')">
		      order by enrolldate asc
		    </if>
		<if test="order.equals('asc')">
		      order by enrolldate desc
   	    </if>
		<!-- <choose>
		    <when test="order !=null and order !=''">
		      order by enrolldate asc
		    </when>
		    <otherwise>
		      order by enrolldate desc
   			</otherwise>
  		</choose> -->
		
	</select>
	
	<select id="projectlist" resultType="com.zestworld.Table_DTO.Project_DTO">
		
		select * from project
		
	</select> 
	
	<select id="writerlist" parameterType="String" resultType="com.zestworld.Table_DTO.WorkspaceUser_DTO">
		
		select user_id from workspace_user where workspace_id=#{workspace_id}
		
	</select> 
	
	<insert id="insertTask" parameterType="com.zestworld.Table_DTO.Task_DTO">
		insert into task(task_id,category_id,user_id,title,end_date,success_f,enrolldate) values (task_seq.nextval,#{category_id},#{user_id},#{title},#{end_date},'0',sysdate)
	</insert>

<!-- 	프로젝트에 속한 category name -->
	<select id ="categorylist" parameterType="int" resultType="com.zestworld.Table_DTO.Category_DTO">
		select category_id,title from category where project_id =#{projectId}
	</select>
<!-- 		
	task 테이블의 cate_id를 이용해서 c.title추출 (중복값 제거)
	<select id="catetitlelist" parameterType="com.zestworld.Table_DTO.category_DTO">
		select distinct c.title, c.cate from task t, category c where t.category_id=c.category_id
	</select>

 -->
	
	<select id ="detailTask" parameterType="String" resultType="com.zestworld.Table_DTO.Task_DTO">
		select * from task where task_id =#{task_id}
	</select>
	
	<!-- 업무상태 flag update -->
	<update id ="updateFlag" parameterType="String" >
		update task set success_f=1 where task_id=#{task_id}
	</update>
	
</mapper>


